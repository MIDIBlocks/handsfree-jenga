<!DOCTYPE html>
<html>
<head>
  <!-- Load Handsfree.js from CDN -->
  <link rel="stylesheet" href="https://unpkg.com/handsfree@7.2.12/build/lib/assets/handsfree.css" />
  <script src="https://unpkg.com/handsfree@7.2.12/build/lib/handsfree.js"></script>

  <!-- App Stuff -->
  <title>Handsfree Jenga ðŸ§±ðŸ‘Œ</title>
  <link rel="icon" type="image/jpg" href="/assets/img/favicon.jpg">
  <link rel="stylesheet" href="/assets/style.css">
</head>
<body>
  <!-- Glitch Remix button -->
  <div class="glitchButton"></div><script src="https://button.glitch.me/button.js"></script>

  <!-- Scene -->
  <div id="jenga-container" style="background-color: white;"></div>
    
  <!-- Handsfree buttons -->
  <button class="handsfree-show-when-stopped handsfree-hide-when-loading" onclick="startHandsfree()">Start Handtracking ðŸ§±ðŸ‘Œ</button>
  <button class="handsfree-show-when-loading" disabled>Loading...</button>
  <button class="handsfree-hide-when-loading handsfree-show-when-started negative" onclick="handsfree.stop()">Stop Handtracking</button>
    
  <!-- Handsfree.js -->
  <script>
    const handsfree = new Handsfree({hand: true})
    
    /**
     * Starts Handsfree.js and the Jenga project
     */
    function startHandsfree () {
      handsfree.start()

      document.addEventListener('handsfree-modelLoaded', function () {
        loadDep('handsfree/jengaGrab.js')
        
        // Don't judge me
        loadDep('assets/jenga/stats.min.js',
          () => {loadDep('assets/jenga/physi.js',
            () => {loadDep('assets/jenga/TrackballControls.js',
              () => {loadDep('assets/jenga/jenga.js')})})})
      })
    }

    /**
     * Helper for loading dependencies
     */
    function loadDep (src, callback) {
      const $script = document.createElement('script')
      $script.src = src + '?v=' + Math.random()

      if (callback) {
        $script.onload = callback
      }
      
      document.body.appendChild($script)
    }
  </script>
</body>
</html>
